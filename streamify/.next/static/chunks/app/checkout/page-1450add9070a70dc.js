(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[279],{23474:(e,t,s)=>{Promise.resolve().then(s.bind(s,65750))},57832:(e,t,s)=>{"use strict";s.d(t,{Pt:()=>a,yt:()=>c,Cn:()=>n});let i=(0,s(10851).UU)("https://xasddxeipcsewjpsvyic.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inhhc2RkeGVpcGNzZXdqcHN2eWljIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDU3OTA4MDcsImV4cCI6MjA2MTM2NjgwN30.sVq9EXd2OFQtUoyb7AQwBRikQjBWMlVcaIdjdemY8_8");async function a(e){let t=e.map(e=>({track_id:e,qty:1}));return i.rpc("f_checkout",{p_customer:1,p_items:t})}async function c(){let{data:e,error:t}=await i.rpc("f_sales_by_month");if(t)throw t;return e}async function n(){let{data:e,error:t}=await i.rpc("f_top_tracks_sales");if(t)throw t;return e}},65453:(e,t,s)=>{"use strict";s.d(t,{v:()=>l});var i=s(33670);let a=e=>{let t,s=new Set,i=(e,i)=>{let a="function"==typeof e?e(t):e;if(!Object.is(a,t)){let e=t;t=(null!=i?i:"object"!=typeof a||null===a)?a:Object.assign({},t,a),s.forEach(s=>s(t,e))}},a=()=>t,c={setState:i,getState:a,getInitialState:()=>n,subscribe:e=>(s.add(e),()=>s.delete(e))},n=t=e(i,a,c);return c},c=e=>e?a(e):a,n=e=>e,r=e=>{let t=c(e),s=e=>(function(e,t=n){let s=i.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return i.useDebugValue(s),s})(t,e);return Object.assign(s,t),s},l=e=>e?r(e):r},65750:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});var i=s(22342),a=s(57832),c=s(78017),n=s(18999);function r(){let e=(0,c._)(),t=(0,c._)(e=>e.clear),s=(0,n.useRouter)(),r=e.items.reduce((e,t)=>e+t.price,0).toFixed(2);async function l(){if(0!==e.items.length)try{let{error:i}=await (0,a.Pt)(e.items.map(e=>e.track_id));if(i)throw i;t(),s.push("/success")}catch(e){alert("Payment failed: "+e.message)}}return(0,i.jsxs)("main",{className:"mx-auto max-w-md space-y-6 p-6 bg-white rounded-lg shadow",children:[(0,i.jsx)("h1",{className:"text-2xl font-semibold",children:"Your Cart"}),0===e.items.length?(0,i.jsx)("p",{className:"text-gray-500",children:"Your cart is empty."}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("ul",{className:"space-y-2",children:e.items.map(e=>(0,i.jsxs)("li",{className:"flex justify-between border-b pb-2 last:border-b-0",children:[(0,i.jsx)("span",{children:e.name}),(0,i.jsxs)("span",{children:["$",e.price.toFixed(2)]})]},e.track_id))}),(0,i.jsxs)("div",{className:"flex justify-between text-lg font-medium",children:[(0,i.jsx)("span",{children:"Total"}),(0,i.jsxs)("span",{children:["$",r]})]}),(0,i.jsx)("button",{onClick:l,disabled:0===e.items.length,className:"w-full rounded bg-indigo-600 py-2 text-white disabled:opacity-50",children:"Pay"})]})]})}},78017:(e,t,s)=>{"use strict";s.d(t,{_:()=>i});let i=(0,s(65453).v)(e=>({items:[],add:t=>e(e=>({items:[...e.items,t]})),remove:t=>e(e=>({items:e.items.filter(e=>e.track_id!==t)})),clear:()=>e({items:[]})}))}},e=>{var t=t=>e(e.s=t);e.O(0,[851,708,451,358],()=>t(23474)),_N_E=e.O()}]);