{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":["file:///Users/shauryamathur/Documents/Spring%202025/CSE460-DMQL/Project/trackzy/streamify/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js'\n\nexport const supabase = createClient(\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n)\n"],"names":[],"mappings":";;;AAAA;;AAEO,MAAM,WAAW,CAAA,GAAA,uLAAA,CAAA,eAAY,AAAD","debugId":null}},
    {"offset": {"line": 67, "column": 0}, "map": {"version":3,"sources":["file:///Users/shauryamathur/Documents/Spring%202025/CSE460-DMQL/Project/trackzy/streamify/lib/api.ts"],"sourcesContent":["import { supabase } from './supabase';\n\nexport interface AlbumTree {\n    album_id:   number\n    album:      string\n    artist:     string\n    tracks: {\n      track_id: number\n      name:     string\n      seconds:  number\n      price:    number\n    }[]\n  }\n  \n\nexport async function fetchAlbums(search: string) {\n    // empty string ⇒ no filter\n    const base = supabase.from('v_album_tree').select('*').order('artist')\n  \n    const { data, error } =\n      search.trim() === ''\n        ? await base\n        : await base.or(\n            `album.ilike.%${search}%,artist.ilike.%${search}%`\n          ) // ↙ case-insensitive\n  \n    if (error) throw error\n    return data\n  }\n\n  export async function checkout(items: number[]) {\n    // p_items is an array of {track_id,qty}\n    const payload = items.map((id) => ({ track_id: id, qty: 1 }))\n    // return the full response object\n    return supabase.rpc('f_checkout', {\n      p_customer: 1,\n      p_items: payload,\n    })\n  }\n\n  export type MonthlySale = { month: string; revenue: number }\nexport type TopTrack    = { track_id: number; name: string; units_sold: number }\n\nexport async function fetchSalesByMonth(): Promise<MonthlySale[]> {\n  const { data, error } = await supabase.rpc('f_sales_by_month')\n  if (error) throw error\n  return data!\n}\n\nexport async function fetchTopTracks(): Promise<TopTrack[]> {\n  const { data, error } = await supabase.rpc('f_top_tracks_sales')\n  if (error) throw error\n  return data!\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAeO,eAAe,YAAY,MAAc;IAC5C,2BAA2B;IAC3B,MAAM,OAAO,+GAAA,CAAA,WAAQ,CAAC,IAAI,CAAC,gBAAgB,MAAM,CAAC,KAAK,KAAK,CAAC;IAE7D,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GACnB,OAAO,IAAI,OAAO,KACd,MAAM,OACN,MAAM,KAAK,EAAE,CACX,CAAC,aAAa,EAAE,OAAO,gBAAgB,EAAE,OAAO,CAAC,CAAC,EAClD,qBAAqB;;IAE7B,IAAI,OAAO,MAAM;IACjB,OAAO;AACT;AAEO,eAAe,SAAS,KAAe;IAC5C,wCAAwC;IACxC,MAAM,UAAU,MAAM,GAAG,CAAC,CAAC,KAAO,CAAC;YAAE,UAAU;YAAI,KAAK;QAAE,CAAC;IAC3D,kCAAkC;IAClC,OAAO,+GAAA,CAAA,WAAQ,CAAC,GAAG,CAAC,cAAc;QAChC,YAAY;QACZ,SAAS;IACX;AACF;AAKK,eAAe;IACpB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,+GAAA,CAAA,WAAQ,CAAC,GAAG,CAAC;IAC3C,IAAI,OAAO,MAAM;IACjB,OAAO;AACT;AAEO,eAAe;IACpB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,+GAAA,CAAA,WAAQ,CAAC,GAAG,CAAC;IAC3C,IAAI,OAAO,MAAM;IACjB,OAAO;AACT","debugId":null}},
    {"offset": {"line": 111, "column": 0}, "map": {"version":3,"sources":["file:///Users/shauryamathur/Documents/Spring%202025/CSE460-DMQL/Project/trackzy/streamify/components/CheckoutClient.tsx"],"sourcesContent":["// components/CheckoutClient.tsx\n'use client'\n\nimport { checkout } from '@/lib/api'\nimport { useCart } from '@/store/useCart'\nimport { useRouter } from 'next/navigation'\n\nexport default function CheckoutClient() {\n  const cart   = useCart()\n  const clear  = useCart(s => s.clear)\n  const router = useRouter()\n\n  const total = cart.items.reduce((sum, i) => sum + i.price, 0).toFixed(2)\n\n  async function handlePay() {\n    if (cart.items.length === 0) return\n    try {\n      const { error } = await checkout(cart.items.map(i => i.track_id))\n      if (error) throw error\n      clear()\n      router.push('/success')\n    } catch (err: any) {\n      alert('Payment failed: ' + err.message)\n    }\n  }\n\n  return (\n    <main className=\"mx-auto max-w-md space-y-6 p-6 bg-white rounded-lg shadow\">\n      <h1 className=\"text-2xl font-semibold\">Your Cart</h1>\n\n      {cart.items.length === 0 ? (\n        <p className=\"text-gray-500\">Your cart is empty.</p>\n      ) : (\n        <>\n          <ul className=\"space-y-2\">\n            {cart.items.map(item => (\n              <li\n                key={item.track_id}\n                className=\"flex justify-between border-b pb-2 last:border-b-0\"\n              >\n                <span>{item.name}</span>\n                <span>${item.price.toFixed(2)}</span>\n              </li>\n            ))}\n          </ul>\n\n          <div className=\"flex justify-between text-lg font-medium\">\n            <span>Total</span>\n            <span>${total}</span>\n          </div>\n\n          <button\n            onClick={handlePay}\n            disabled={cart.items.length === 0}\n            className=\"w-full rounded bg-indigo-600 py-2 text-white disabled:opacity-50\"\n          >\n            Pay\n          </button>\n        </>\n      )}\n    </main>\n  )\n}"],"names":[],"mappings":"AAAA,gCAAgC;;;;;AAGhC;AACA;AACA;AAJA;;;;;AAMe,SAAS;IACtB,MAAM,OAAS,CAAA,GAAA,gHAAA,CAAA,UAAO,AAAD;IACrB,MAAM,QAAS,CAAA,GAAA,gHAAA,CAAA,UAAO,AAAD,EAAE,CAAA,IAAK,EAAE,KAAK;IACnC,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IAEvB,MAAM,QAAQ,KAAK,KAAK,CAAC,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,EAAE,KAAK,EAAE,GAAG,OAAO,CAAC;IAEtE,eAAe;QACb,IAAI,KAAK,KAAK,CAAC,MAAM,KAAK,GAAG;QAC7B,IAAI;YACF,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,CAAA,GAAA,0GAAA,CAAA,WAAQ,AAAD,EAAE,KAAK,KAAK,CAAC,GAAG,CAAC,CAAA,IAAK,EAAE,QAAQ;YAC/D,IAAI,OAAO,MAAM;YACjB;YACA,OAAO,IAAI,CAAC;QACd,EAAE,OAAO,KAAU;YACjB,MAAM,qBAAqB,IAAI,OAAO;QACxC;IACF;IAEA,qBACE,8OAAC;QAAK,WAAU;;0BACd,8OAAC;gBAAG,WAAU;0BAAyB;;;;;;YAEtC,KAAK,KAAK,CAAC,MAAM,KAAK,kBACrB,8OAAC;gBAAE,WAAU;0BAAgB;;;;;qCAE7B;;kCACE,8OAAC;wBAAG,WAAU;kCACX,KAAK,KAAK,CAAC,GAAG,CAAC,CAAA,qBACd,8OAAC;gCAEC,WAAU;;kDAEV,8OAAC;kDAAM,KAAK,IAAI;;;;;;kDAChB,8OAAC;;4CAAK;4CAAE,KAAK,KAAK,CAAC,OAAO,CAAC;;;;;;;;+BAJtB,KAAK,QAAQ;;;;;;;;;;kCASxB,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;0CAAK;;;;;;0CACN,8OAAC;;oCAAK;oCAAE;;;;;;;;;;;;;kCAGV,8OAAC;wBACC,SAAS;wBACT,UAAU,KAAK,KAAK,CAAC,MAAM,KAAK;wBAChC,WAAU;kCACX;;;;;;;;;;;;;;AAOX","debugId":null}}]
}